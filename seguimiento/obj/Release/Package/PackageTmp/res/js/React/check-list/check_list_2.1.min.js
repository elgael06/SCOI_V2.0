"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),_get=function(n,t,i){var e=!0,r,f,o;n:while(e){var u=n,s=t,h=i;if(e=!1,u===null&&(u=Function.prototype),r=Object.getOwnPropertyDescriptor(u,s),r===undefined){if(f=Object.getPrototypeOf(u),f===null)return undefined;n=f;t=s;i=h;e=!0;r=f=undefined;continue n}else return"value"in r?r.value:(o=r.get,o===undefined)?undefined:o.call(h)}},Botonera=function(n){function t(){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){var n=this;return React.createElement("div",null,React.createElement("input",{type:"button",className:"btn btn-primary",value:"Actualizar",onClick:function(){return n.props.actualizar()}}),React.createElement("input",{type:"button",className:"btn btn-primary",value:"Resultados",onClick:function(){return n.props.resultados()}}),React.createElement("input",{type:"button",className:"btn btn-primary",value:"Observaciones",onClick:function(){return n.props.observaciones()}}))}}]),t}(React.Component),Lists_cuestionas_a_responder=function(n){function t(){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){var n=this,t=function(){return n.props.id_usuario>0},i=function(){return n.props.resueltos>0?"btn btn-info btn-lg btn-block":"btn btn-warning btn-lg btn-block"};return React.createElement("input",{type:"button",value:this.props.nombre,key:this.props.identificador,className:i(),disabled:!t(),onClick:function(){return n.props.evento()}})}}]),t}(React.Component),Modal_responder=function(n){function t(){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{id:"moda_cuestionario"},React.createElement("div",{id:"cuerpo_cuestionario",className:"panel panel-default"},React.createElement("div",{id:"cavecera_cuestionario",className:"panel-heading"},React.createElement("span",{className:"glyphicon glyphicon-remove-circle close red",onClick:this.cerrar_modal.bind(this)}),React.createElement("span",{style:{fontSize:"20px",marginLeft:"10px"},className:"glyphicon glyphicon-edit"}," "),React.createElement("label",{style:{fontSize:"20px",marginLeft:"10px"}},this.props.titulo)),this.props.marcador,React.createElement("div",{id:"contenedor_respuestas",className:"panel-body"},React.createElement("table",{className:"table table-striped"},React.createElement("tbody",null,this.props.tabla_pregintas))),React.createElement("span",{className:"btn btn-info btn-block",onClick:this.props.guardar.bind(this)},React.createElement("label",{style:{fontSize:"20px"}},"Guardar  "),React.createElement("span",{style:{marginLeft:"10px",fontSize:"25px"},className:"glyphicon glyphicon-saved"}," "))),React.createElement(Responder,{titulo:this.props.titulo_responder,cuerpo:this.props.cuerpo_responder}))}},{key:"cerrar_modal",value:function(){document.getElementById("moda_cuestionario").style.display="none"}}]),t}(React.Component),Responder=function(n){function t(){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"moda_cresponder",id:"responder_modal"},React.createElement("div",{className:"panel panel-default cuerpo_responder"},React.createElement("div",{className:"panel-heading cavecera_responder",style:{"background-color":"#58c174",color:"black"}},React.createElement("span",{className:"glyphicon glyphicon-remove-circle close red",onClick:this.cerrar_modal.bind(this)}),React.createElement("h3",null,this.props.titulo)),React.createElement("div",{className:"panel-body"},this.props.cuerpo)))}},{key:"cerrar_modal",value:function(){document.getElementById("responder_modal").style.display="none"}}]),t}(React.Component),Cuerpo_observaciones=function(n){function t(n){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,n);this.state={observacion:""}}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){return React.createElement("div",null,React.createElement("input",{type:"text",className:"form-control",style:{width:"277px",marginRight:"5px",display:"inline-block"},onChange:this.on_observaciones_pregunta.bind(this),value:this.state.observacion}),React.createElement("input",{type:"button",value:"Agregar",className:"btn btn-info",onClick:this.on_agregar.bind(this)}),React.createElement("div",{className:"form-control",style:{marginTop:"10px",height:"140px","overflow-x":"auto","overflow-y":"auto"}},React.createElement("table",{className:"table table-bordered"},this.props.lista_observaciones)))}},{key:"on_observaciones_pregunta",value:function(n){console.log(n.target.value);this.setState({observacion:n.target.value})}},{key:"on_agregar",value:function(){var n=this.state.observacion;if(n!="")this.props.on_agregar_observacion(n);else alert("Sin Observaciones...");this.setState({observacion:""})}}]),t}(React.Component),Vista_observaciones=function(n){function t(){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{id:this.props.identificador,className:"moda_cresponder"},React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},React.createElement("span",{className:"glyphicon glyphicon-remove-circle close red",onClick:this.cerrar_modal.bind(this)}),React.createElement("h3",null,this.props.titulo)),React.createElement("div",{className:"panel-body",style:{height:"80%","overflow-x":"auto","overflow-y":"auto"}},React.createElement("table",{className:"table table-bordered",id:this.props.identificador+"reporte_cuestionarios"},React.createElement("tbody",null,this.props.observaciones))),React.createElement("span",{className:"btn btn-info btn-block",onClick:this.exportar.bind(this)},React.createElement("label",null,"Guardar  "),React.createElement("span",{style:{marginLeft:"10px"},className:"glyphicon glyphicon-download-alt"}," "))))}},{key:"cerrar_modal",value:function(){var n=this.props.identificador;document.getElementById(n).style.display="none"}},{key:"exportar",value:function(){console.log("Exportar...");tableToExcel(this.props.identificador+"reporte_cuestionarios","Reporte")}}]),t}(React.Component),Ckl_establecimiento=function(n){function t(n){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,n);this.lista_establecimientos=[];this.lista_cuestionario_por_establecimiento=[];this.lista_preguntas_cuestionario=[];this.lista_observaciones=[];this.resultados=[];this.titulo_responder="";this.cuerpo_responder=[];this.orden=-1;this.state={folio_establecimiento:-1,fecha:this.fecha_hoy(),id_usuario:-1,usuario:"",id_cuestionario:-1,cuestionario:""};this.obtener_establecimientos()}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading",id:"cavecera"},React.createElement(Botonera,{actualizar:this.on_actualizar_.bind(this),resultados:this.on_resultados_.bind(this),observaciones:this.on_observaciones_.bind(this)}),React.createElement("div",{style:{width:"60%",display:"inline-block",marginLeft:"5px"}},React.createElement(Caja_datos_select,{titulo:"Establecimiento",icono:"glyphicon glyphicon-tasks",seleccion:this.on_seleccion_establecimiento.bind(this),opciones:this.opciones_establecimientos()})),React.createElement("div",{style:{width:"25%",display:"inline-block",marginLeft:"5px"}},React.createElement(Caja_fecha,{fecha:this.state.fecha,evento:this.on_seleccion_fecha.bind(this)})),React.createElement("div",{className:"",style:{width:"85%",display:"inline-block","margin-left":"10px"}},React.createElement(Caja_datos,{icono:"glyphicon glyphicon-user",titulo:"Responsable",datos:this.state.usuario}),React.createElement("i",{className:"glyphicon glyphicon-search",title:"Buscar Usuario","data-toggle":"modal","data-target":"#modal_usuarios"})),React.createElement(Modal,{id:"modal_usuarios",cerrar:function(){console.log("cancelar")},cavecera:React.createElement("h3",null,"Seleccion Usuario"),cuerpo:React.createElement(Seleccion_usuario,{seleccionar:this.on_seleccion_usuario.bind(this)})})),React.createElement("div",{className:"panel-body",id:"cuerpo"},React.createElement("div",{id:"contenedor_botones_cuestionarios"},this.opciones_cuestionarios_por_establecimiento())),React.createElement(Modal_responder,{titulo:this.state.cuestionario,marcador:this.datos_marcador_preguntas(),tabla_pregintas:this.datos_preguntas(),titulo_responder:this.titulo_responder,guardar:this.guardar_respuestas.bind(this),cuerpo_responder:this.cuerpo_responder}),React.createElement(Vista_observaciones,{identificador:"total_obsercaciones",titulo:"Resultados.",observaciones:this.datos_tabla_obsercaciones()}),React.createElement(Vista_observaciones,{identificador:"total_Resultados",titulo:"Resultados.",observaciones:this.datos_tabla_resultados()}))}},{key:"on_actualizar_",value:function(){console.log("actualizar");var n=this.state.folio_establecimiento;n>0?this.obtener_cuestionarios_establecimiento(n):alert("Seleccione Establecimiento...")}},{key:"on_resultados_",value:function(){var n=this;console.log("resultados");conexion_api_from_body("servicios/checkListServ.asmx/procedimiento_resultados_cuestionario_por_dia",{folio_establecimiento:this.state.folio_establecimiento,fecha:this.state.fecha},function(t){n.resultados=t.d;n.setState({});document.getElementById("total_Resultados").style.display="flex"})}},{key:"on_observaciones_",value:function(){var n=this;console.log("observaciones");conexion_api_from_body("servicios/checkListServ.asmx/obtener_observaciones",{folio_establecimiento:this.state.folio_establecimiento,fecha:this.state.fecha},function(t){n.lista_observaciones=t.d;n.setState({});document.getElementById("total_obsercaciones").style.display="flex"})}},{key:"on_seleccion_establecimiento",value:function(n){this.obtener_cuestionarios_establecimiento(n.target.value);this.setState({folio_establecimiento:n.target.value,id_usuario:-1,usuario:""})}},{key:"on_seleccion_fecha",value:function(n){var t=n.target.value.split("-");t[0]>0?this.setState({fecha:t[2]+"/"+t[1]+"/"+t[0]}):this.setState({fecha:this.fecha_hoy()});this.on_actualizar_()}},{key:"on_seleccion_usuario",value:function(n){this.setState({id_usuario:n.id,usuario:n.nombre})}},{key:"on_seleccionar_cuestionario",value:function(n){console.info(n);this.obtener_preguntas(n.id_cuestionario);this.obtener_observaciones();this.setState({cuestionario:n.cuestionario});document.getElementById("moda_cuestionario").style.display="block"}},{key:"on_responder",value:function(n){this.titulo_responder=n.pregunta;this.cuerpo_responder=this.cuerpo_responder_ico(n);document.getElementById("responder_modal").style.display="flex";this.setState({})}},{key:"on_observaciones",value:function(n){var i=this,t;this.titulo_responder="Lista De Observaciones.";this.orden=n.orden;t=this.lista_observaciones.filter(function(t){return t.posicion==n.orden&&t.cuestionario==i.state.cuestionario});t=React.createElement("tbody",null,t.map(function(n,t){return React.createElement("tr",null,React.createElement("td",null,t+1),React.createElement("td",null,React.createElement("label",null,n.observaciones)),React.createElement("td",null,React.createElement("span",{className:"glyphicon glyphicon-trash red",onClick:function(){return i.remover_observaciones(n.folio)}})))}));this.cuerpo_responder=React.createElement(Cuerpo_observaciones,{on_agregar_observacion:this.agregar_observacion.bind(this),lista_observaciones:t});this.setState({});document.getElementById("responder_modal").style.display="flex"}},{key:"fecha_hoy",value:function(){var n=new Date,t=n.getDate()>9?n.getDate():"0"+n.getDate(),i=n.getMonth()+1>9?n.getMonth()+1:"0"+(n.getMonth()+1);return t+"/"+i+"/"+n.getFullYear()}},{key:"obtener_establecimientos",value:function(){var n=this;conexion_api_2("servicios/checkListServ.asmx/buscar_establecimiento",function(t){n.lista_establecimientos=t.d;n.setState({folio_establecimiento:-1})})}},{key:"obtener_cuestionarios_establecimiento",value:function(n){var t=this;conexion_api_from_body("servicios/checkListServ.asmx/cuestionarios_por_establecimiento_R",{id_establecimiento:n,fecha:this.state.fecha},function(n){console.log(n.d);t.lista_cuestionario_por_establecimiento=n.d;t.setState({id_cuestionario:-1,cuestionario:""})})}},{key:"obtener_preguntas",value:function(n){var t=this;conexion_api_from_body("servicios/checkListServ.asmx/obtener_Preguntas_cuestionario",{establecimiento:this.state.folio_establecimiento,cuestionario:n,fecha:this.state.fecha},function(i){console.log(i.d);t.lista_preguntas_cuestionario=i.d;t.setState({id_cuestionario:n})})}},{key:"obtener_observaciones",value:function(){var n=this;conexion_api_from_body("servicios/checkListServ.asmx/obtener_observaciones",{folio_establecimiento:this.state.folio_establecimiento,fecha:this.state.fecha},function(t){n.lista_observaciones=t.d;console.log(t.d);n.setState({})})}},{key:"agregar_observacion",value:function(n){var t=this;console.log(this.orden,n);conexion_api_from_body("servicios/checkListServ.asmx/guardar_observaciones",{fecha:this.state.fecha,folio_establecimiento:this.state.folio_establecimiento,id_cuestionario:this.state.id_cuestionario,observaciones:n,posicion_pregunta:this.orden,usuario:ID_SCOI},function(){document.getElementById("responder_modal").style.display="none";t.obtener_observaciones()})}},{key:"remover_observaciones",value:function(n){var t=this;console.log("remover:",n);confirm("Eliminar Observacion?")&&conexion_api_from_body("servicios/checkListServ.asmx/Eliminar_observaciones",{folio:n},function(){document.getElementById("responder_modal").style.display="none";t.obtener_observaciones()})}},{key:"guardar_respuestas",value:function(){var n=this,t;console.log(this.lista_preguntas_cuestionario);t=this.lista_preguntas_cuestionario.filter(function(n){return n.respuesta<3}).length;t===this.lista_preguntas_cuestionario.length?(console.info("SI"),conexion_api_from_body("servicios/checkListServ.asmx/guardar_datos_3",{sucursal:this.state.folio_establecimiento,fecha:this.state.fecha,zona:this.state.id_cuestionario,criterio:this.lista_preguntas_cuestionario.map(function(n){return n.orden}),respuestas:this.lista_preguntas_cuestionario.map(function(n){return n.respuesta}),datos_pregunta:this.lista_preguntas_cuestionario.map(function(n){return n.pregunta}),observaciones:"00:00:00",aplicador:parseInt(ID_SCOI),encargado:this.state.usuario||"NA"},function(){document.getElementById("moda_cuestionario").style.display="none";n.obtener_cuestionarios_establecimiento(n.state.folio_establecimiento);alert("Guardado!!!")})):alert("Hay Preguntas Por Responder...")}},{key:"opciones_establecimientos",value:function(){return[React.createElement("option",{value:"-1"},"Seleccione Establecimiento"),this.lista_establecimientos.map(function(n){return React.createElement("option",{key:n.id_establecimiento,value:n.id_establecimiento},n.nombre_establecimiento)})]}},{key:"opciones_cuestionarios_por_establecimiento",value:function(){var n=this,t=this.state.id_usuario;return console.info("Cuestionarios"),this.lista_cuestionario_por_establecimiento.map(function(i){return React.createElement(Lists_cuestionas_a_responder,{id_usuario:t,resueltos:i.resueltos,evento:function(){return n.on_seleccionar_cuestionario(i)},identificador:i.id_cuestionario,nombre:i.cuestionario})})}},{key:"datos_marcador_preguntas",value:function(){var t=this.lista_preguntas_cuestionario.filter(function(n){return n.respuesta===1}).length,i=this.lista_preguntas_cuestionario.filter(function(n){return n.respuesta===0}).length,r=this.lista_preguntas_cuestionario.filter(function(n){return n.respuesta===2}).length,n=Math.round(t/(t+i)*1e4)/100;return n=n>0?n:0,n=n<100?n:100,React.createElement("div",{id:"contenedor_marcadores"},React.createElement("span",null," SI :",React.createElement("input",{style:{"background-color":"green"},className:"marcadores form-control",value:t})),React.createElement("span",null," NO",React.createElement("input",{style:{"background-color":"red"},className:"marcadores form-control",value:i})),React.createElement("span",null," NA",React.createElement("input",{style:{"background-color":"blue"},className:"marcadores form-control",value:r})),React.createElement("span",null," TOTAL",React.createElement("input",{style:{"background-color":"gray"},className:"marcadores form-control",value:n})," %"))}},{key:"datos_preguntas",value:function(){var n=this,t=function(n){return n==1?"glyphicon glyphicon-ok-sign":n==2?"glyphicon glyphicon-info-sign":n==0?"glyphicon glyphicon-remove-sign":"glyphicon glyphicon-question-sign"};return this.lista_preguntas_cuestionario.map(function(t){return React.createElement("tr",null,React.createElement("td",null,React.createElement("h3",null,t.orden)),React.createElement("td",{style:{textAlign:"left"}},React.createElement("div",{style:{fontSize:"15px"}},React.createElement("label",null,"CRITERIO : ")," ",t.pregunta),React.createElement("div",null,React.createElement("label",null,"AREA: ")," ",t.pertenece)),React.createElement("td",{onClick:function(){return n.on_responder(t)}},n.componente_vista_respuesta(t.respuesta)),React.createElement("td",null," ",React.createElement("span",{style:{color:"#2877a0",fontSize:"35px"},className:"fa fa-comments",onClick:function(){return n.on_observaciones(t)},title:"Observaciones"})))})}},{key:"componente_vista_respuesta",value:function(n){var t=function(n){return n==1?"glyphicon glyphicon-ok-sign":n==2?"glyphicon glyphicon-info-sign":n==0?"glyphicon glyphicon-remove-sign":"glyphicon glyphicon-question-sign"};return React.createElement("span",{style:{color:["red","green","blue","gray"][n]},className:t(n)})}},{key:"datos_tabla_obsercaciones",value:function(){var n=this;return this.lista_observaciones.map(function(t,i){return React.createElement("tr",null,React.createElement("td",null,i+1),React.createElement("td",null,t.observaciones),React.createElement("td",null,React.createElement("span",{className:"glyphicon glyphicon-trash red",onClick:function(){return n.remover_observaciones(t.folio)}})))})}},{key:"cuerpo_responder_ico",value:function(n){var i=this,t=function(t){n.respuesta=t;document.getElementById("responder_modal").style.display="none";i.setState({})};return React.createElement("div",null,React.createElement("label",{onClick:function(){return t(1)},style:{fontSize:"50px",marginLeft:"70px"}}," ",this.componente_vista_respuesta(1)),React.createElement("label",{onClick:function(){return t(0)},style:{fontSize:"50px",marginLeft:"30px"}}," ",this.componente_vista_respuesta(0)),React.createElement("label",{onClick:function(){return t(2)},style:{fontSize:"50px",marginLeft:"30px"}}," ",this.componente_vista_respuesta(2)))}},{key:"datos_tabla_resultados",value:function(){return console.log("Resultado:",this.resultados),React.createElement(Resultados,{datos:this.resultados})}}]),t}(React.Component),Resultados=function(n){function t(){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){return this.tabla_datos()}},{key:"tabla_datos",value:function(){var t=this,i=0,r="",n=[],u=this.props.datos.map(function(u){i==0&&(r=u.zona_inspeccion,n.push(t.cavecera_res(u)),n.push(t.puntos_res()));u.zona_inspeccion==r?u.posicion==1?n.push(t.cuerpo_resultados(u)):n.push(t.cuerpo_resultados(u)):(i=0,r=u.zona_inspeccion,n.push(t.cavecera_res(u)),n.push(t.puntos_res()),n.push(t.cuerpo_resultados(u)));i=1});return n}},{key:"cavecera_res",value:function(n){return React.createElement("tr",{className:"info"},React.createElement("th",{rowspan:"2",style:{width:"50px","text-align":"center"}},"#"),React.createElement("th",{rowspan:"2",style:{"text-align":"center"}},n.zona_inspeccion),React.createElement("th",{colspan:"3",style:{width:"150px","text-align":"center"}},"CUMPLE"),React.createElement("th",{rowspan:"2",style:{width:"50px","text-align":"center"}},"PERTENECE"))}},{key:"puntos_res",value:function(){return React.createElement("tr",null,React.createElement("td",null,"SI"),React.createElement("td",null,"NO"),React.createElement("td",null,"NA"))}},{key:"cuerpo_resultados",value:function(n){var t=n.rsi==1&n.rno==0?"green":"",i=n.rsi==0&n.rno==1?"red":"",r=n.caducidad==1?"limpieza":n.surtido==1?"surtido":n.imagen==1?"imagen":n.generales==1?"generales":n.senializaciores==1?"señalizacion":n.limpieza==1?"limpieza":"NA";return React.createElement("tr",{className:"table"},React.createElement("td",null,n.posicion),React.createElement("td",{style:{"text-align":"left"}},n.pregunta),React.createElement("td",{style:{background:t}},n.rsi==1?"X":""),React.createElement("td",{style:{background:i}},n.rno==1?"X":""),React.createElement("td",null,n.rna==1?"X":""),React.createElement("td",null,r))}},{key:"resultados",value:function(){var n=this.props.datos.filter(function(n){return n.rsi==1}).length,t=this.props.datos.filter(function(n){return n.rno==1}).length,i=this.props.datos.filter(function(n){return n.rna==1}).length;return React.createElement("span",{className:"marcador_r",style:{top:"35px",right:"30px"}},React.createElement("span",{className:"success"},"SI : ",n),React.createElement("span",{className:"danger"},"NO : ",t),React.createElement("span",{className:"info"},"NA : ",i),React.createElement("span",null,"TOTAL : ",Math.round(n/(t+n)*1e3)/10>=0?Math.round(n/(t+n)*1e3)/10:0," % "))}}]),t}(React.Component);ReactDOM.render(React.createElement(Ckl_establecimiento,null),document.getElementById("padre"));