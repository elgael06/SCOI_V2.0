"use strict";function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),_get=function(n,t,i){var e=!0,r,f,o;n:while(e){var u=n,s=t,h=i;if(e=!1,u===null&&(u=Function.prototype),r=Object.getOwnPropertyDescriptor(u,s),r===undefined){if(f=Object.getPrototypeOf(u),f===null)return undefined;n=f;t=s;i=h;e=!0;r=f=undefined;continue n}else return"value"in r?r.value:(o=r.get,o===undefined)?undefined:o.call(h)}},$MI_URL=window.location.protocol+"//"+window.location.hostname,$URL_API=$MI_URL+":90/api/",ObjIncidencia=function ObjIncidencia(){_classCallCheck(this,ObjIncidencia);this.Checador="";this.Color="#FFFFFF";this.Descripcion="";this.Folio=-1;this.Incidencia=0;this.Nombre="";this.Puesto=""},Incidencias=function(n){function t(n){_classCallCheck(this,t);_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,n);this.state={Establecimiento:0,diferencia:0,Departamentos:[],Establecimientos:[],Seleccion:{},Incidencia:new ObjIncidencia,vistaReporte:0};this.Seleccion_departamento=this.on_departamento.bind(this);this.incidencia=this.on_incidencia.bind(this);this.incidencia_detalle=this.on_incidencia_detalle.bind(this);this.cambioIncidencia=this.on_cambio_incidencia.bind(this);this.cambioIncidencia_detalle=this.on_cambio_incidencia_descripcion.bind(this);this.evGuardarCambioEmpleado=this.on_guardar_cambio_Incidencia_empleado.bind(this);this.evGuardarCambioEmpleado_detalle=this.on_guardar_observaciones_incidencia.bind(this);this.evReporte=this.on_reporte.bind(this);this.guardado=this.on_guardar_incidemcas_departamento.bind(this);setTimeout(function(){return document.getElementById("pantalla_carga").style.display="none"},1e3);setTimeout(this.ObtenerEstablecimientos(),100)}return _inherits(t,n),_createClass(t,[{key:"on_establecimiento",value:function(n){console.log(n.target.value);this.setState({Establecimiento:n.target.value,Departamentos:[]})}},{key:"on_dia",value:function(n){this.setState({diferencia:n.target.value,Departamentos:[]})}},{key:"on_recargar",value:function(){this.setState({Departamentos:[]});this.ObtenerDepartamentos()}},{key:"on_departamento",value:function(n){console.log(n);this.setState({Seleccion:n});document.getElementById("modal_incidencias").style.display="flex"}},{key:"on_incidencia",value:function(n){this.Seleccion_incidencia(n);console.log("Incidencia=>",this.state.Incidencia);document.querySelector("#Cambio_incidencia").style.display="flex"}},{key:"on_incidencia_detalle",value:function(n){this.Seleccion_incidencia(n);console.log("Detalle=>",this.state.Incidencia);document.querySelector("#Cambio_incidencia_observacion").style.display="flex"}},{key:"on_cambio_incidencia",value:function(n){var i=n.Color,r=n.Criterio,t=this.state.Incidencia;t.Color=i;t.Checador=r;this.setState({Incidencia:t})}},{key:"on_cambio_incidencia_descripcion",value:function(n){var t=this.state.Incidencia;t.Descripcion=n.target.value;this.setState({Incidencia:t})}},{key:"on_guardar_cambio_Incidencia_empleado",value:function(){var n=this.state.Incidencia,f=n.Checador,e=n.Color,r=n.Folio,u=this.state.Seleccion,t=u.Lista,o=t.findIndex(function(n){return n.Folio==r}),i=t.find(function(n){return n.Folio==r});i.Checador=f;i.Color=e;t[o]=i;this.setState({Seleccion:u});document.querySelector("#Cambio_incidencia").style.display="none"}},{key:"on_guardar_observaciones_incidencia",value:function(){console.log("Guardado=>",this.state.Seleccion);document.querySelector("#Cambio_incidencia_observacion").style.display="none";var t=this.state.Incidencia,i=t.Folio,f=t.Descripcion,r=this.state.Seleccion,n=r.Lista,e=n.findIndex(function(n){return n.Folio==i}),u=n.find(function(n){return n.Folio==i});u.Descripcion=f;n[e]=u;this.setState({Seleccion:r})}},{key:"on_guardar_incidemcas_departamento",value:function(){var n=this.state.Seleccion;this.Cargando(1);console.log("Datos=>",n);this.enviarDatosGuardar(n)}},{key:"on_reporte",value:function(n){this.setState({vistaReporte:n});document.querySelector("#modal_reporte").style.display=n==1?"flex":""}},{key:"LlenarEstablecimientos",value:function(n){this.setState({Establecimientos:n,Establecimiento:n[0].folio});this.Cargando(0)}},{key:"LlenarDepartamentos",value:function(n){this.setState({Departamentos:n});this.Cargando(0)}},{key:"Cargando",value:function(n){document.getElementById("pantalla_carga")&&(document.getElementById("pantalla_carga").style.display=n==1?"flex":"none")}},{key:"Seleccion_incidencia",value:function(n){var t=this.state.Seleccion.Lista[n]||null,i;Selection!=null&&(console.log("Seleccion => ",t),i={Checador:t.Checador,Color:t.Color,Descripcion:t.Descripcion,Folio:t.Folio,Incidencia:t.Incidencia,Nombre:t.Nombre,Puesto:t.Puesto},this.setState({Incidencia:i}))}},{key:"QuitarSeleccion",value:function(n){this.Cargando(0);console.log("respuesta=>",n);alert("Guardado...");document.querySelector("#modal_incidencias").style.display="none";this.setState({Seleccion:{}});this.ObtenerDepartamentos()}},{key:"ObtenerEstablecimientos",value:function(){var n=this;this.Cargando(1);fetch($URL_API+"obtener_establecimientos",{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then(function(t){return t.json().then(function(t){return n.LlenarEstablecimientos(t)})})["catch"](function(n){return console.log(n)})}},{key:"ObtenerDepartamentos",value:function(){var n=this;this.Cargando(1);fetch($URL_API+"Pesonal_Incidencia/?folio="+this.state.Establecimiento+"&diferencia="+this.state.diferencia,{method:"get",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then(function(t){return t.json().then(function(t){return n.LlenarDepartamentos(t)})})["catch"](function(n){return console.log(n)})}},{key:"enviarDatosGuardar",value:function(n){var t=this,i=n.Lista;fetch($URL_API+"PersonalInsidenciasGuardar?capturo="+parseInt(ID_SCOI)+"&fecha="+n.Dia,{method:"post",body:JSON.stringify(i),credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then(function(n){return n.json().then(function(n){return t.QuitarSeleccion(n)})})["catch"](function(n){return console.log(n)})}},{key:"render",value:function(){var t=this,n=this.state,e=n.Establecimiento,i=n.Establecimientos,o=n.diferencia,r=n.Departamentos,u=n.Seleccion,f=n.Incidencia,h=n.vistaReporte,s=i.find(function(n){return n.folio==e})||{};return React.createElement("div",{className:"panel panel-default"},React.createElement(Cavecera,{establecimientos:i,diferencia:o,evEstablecimiento:function(n){return t.on_establecimiento(n)},evDia:function(n){return t.on_dia(n)},evReload:function(){return t.on_recargar()}}),React.createElement(TablaDepartamentos,{Departamentos:r,evDepartamento:this.Seleccion_departamento}),React.createElement(ModalChecarIncidencias,{depatamento:u,evIncidencia:this.incidencia,evDescripcion:this.incidencia_detalle,evGuardar:this.guardado}),React.createElement(ModalCambioIcidecia,{empleado:f,listaInsidencias:u.Criterios||[],evCambiarPuesto:this.cambioIncidencia,evGuardar:this.evGuardarCambioEmpleado}),React.createElement(ModalAgregarObservaciones,{empleado:f,evObservaciones:this.cambioIncidencia_detalle,evGuardar:this.evGuardarCambioEmpleado_detalle}),React.createElement(Resultados,{Establecimiento:s,Departamentos:r,evReporte:this.evReporte}),React.createElement(Cargar,{nombre:"pantalla_carga"}))}}]),t}(React.Component),Cargar=function(n){var t=n.nombre;return React.createElement("div",{id:t,style:{display:"flex",position:"fixed",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(242, 242, 242, 0.79)",top:0,bottom:0,left:0,right:0,zIndex:9999,fontSize:"40px"}},React.createElement("label",{id:t+1},React.createElement("i",{className:"fa fa-circle-o-notch rotate"}),React.createElement("strong",{style:{fontSize:"20px"}}," Cargando..."),React.createElement("br",null)))},Cavecera=function(n){var t=n.establecimientos,i=n.dia,r=n.evEstablecimiento,u=n.evDia,f=n.evReload;return React.createElement("div",{className:"panel-heading"},React.createElement("div",{id:"contenedor_establecimiento"},React.createElement("strong",null,"Establecimiento"),React.createElement("select",{className:"form-control",onChange:r},t.map(function(n){return React.createElement("option",{value:n.folio},n.nombre)}))),React.createElement("div",{id:"contenedor_diferencia"},React.createElement("strong",null,"Dias Diferencia:"),React.createElement("select",{className:"form-control","default":i,onChange:u},React.createElement("option",{value:"0"},"Hoy"),React.createElement("option",{value:"1"},"Ayer"),React.createElement("option",{value:"2"},"Hace 2"),React.createElement("option",{value:"3"},"Hace 3"),React.createElement("option",{value:"4"},"Hace 4"),React.createElement("option",{value:"5"},"Hace 5"),React.createElement("option",{value:"6"},"Hace 6"))),React.createElement("i",{className:"btn btn-success",id:"recargar",title:"Recargar",onClick:f},React.createElement("i",{className:" fa fa-refresh"})))},TablaDepartamentos=function(n){var t=n.Departamentos,i=n.evDepartamento,r=function(){return t.map(function(n){return React.createElement(u,{depatamento:n})})},u=function(n){var t=n.depatamento,r=function(n){return n?"panel panel-success ViewDepartamento":"panel panel-default ViewDepartamento"};return React.createElement("div",{className:r(t.Revicion)},React.createElement("div",{className:"panel-heading"},React.createElement("i",{className:"fa fa-calendar",style:{float:"left",fontSize:"25px"}}," "),React.createElement("h4",{style:{marginLeft:"35px"}}," ",t.Descripcion)),React.createElement("div",{className:"panel-body"},React.createElement("label",{style:{width:"200px"}},React.createElement("i",{className:"fa fa-users",style:{float:"left",marginLeft:"5px",color:"#000000",fontSize:"20px"}}," "),React.createElement("h4",{style:{marginLeft:"35px",color:"#000000"}},"Plantilla"),React.createElement("span",{style:{width:"40%"}},React.createElement("strong",null,"Autorizada :")," ",t.Plantilla_autorizada,"."),React.createElement("span",{style:{width:"40%",marginLeft:"15px"}},React.createElement("strong",null,"Real :")," ",t.Plantilla_real,".")),React.createElement("i",{className:"btn btn-primary btn_check",onClick:function(){return i(t)},style:{fontSize:"25px",borderRadius:"34px"}},React.createElement("i",{className:"fa fa-edit"}))))};return React.createElement("div",{className:"panel-body",id:"cuerpo_tabla"},React.createElement("h4",null,"Departamentos"),React.createElement("div",{className:"panel-group"},React.createElement(r,null)))},ModalChecarIncidencias=function(n){var t=n.depatamento,i=n.evIncidencia,r=n.evDescripcion,u=n.evGuardar,f=function(){var n=t.Lista||[],u=function(n){return"btn "+(n>0?"btn-success fa fa-calendar-check-o":" btn-default fa fa-calendar-minus-o")};return n.map(function(n,t){return React.createElement("div",{style:{fontSize:"12px"},className:"panel panel-info indicador_empleado"},React.createElement("div",{style:{height:"60px",fontSize:"18px"},className:"panel-heading"},React.createElement("i",{className:"fa fa-user",style:{float:"left",fontSize:"20px"}}),React.createElement("strong",{style:{color:"#000000",marginLeft:"20px"}},n.Nombre),React.createElement("i",{className:u(n.Incidencia),style:{float:"right",fontSize:"20px"}})),React.createElement("div",{style:{height:"70px"},className:"panel-body"},React.createElement("label",null,n.Puesto),React.createElement("i",{className:"btn btn-primary",style:{float:"right",borderRadius:"30px",fontSize:"15px"},onClick:function(){return r(t)}},React.createElement("i",{className:"fa fa-commenting-o"})),React.createElement("i",{className:"btn btn-default fa fa-edit",onClick:function(){return i(t)},style:{float:"right",fontSize:"15px",marginRight:"15px"}},React.createElement("strong",{style:{marginLeft:"5px"}},n.Checador),React.createElement("i",{className:"btn btn-default fa fa-exchange",style:{background:n.Color,marginLeft:"5px",borderRadius:"23px"}}))))})};return React.createElement("div",{id:"modal_incidencias",className:"modal_incidencias"},React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading",style:{color:"#FFFFFF",background:"#4dc3ff"}},React.createElement("i",{className:"btn btn-danger fa fa-close",style:{float:"right",fontSize:"18px"},onClick:function(){return document.getElementById("modal_incidencias").style.display="none"}}),React.createElement("i",{className:"fa fa-edit",style:{float:"left"}}),React.createElement("h4",{style:{marginLeft:"40px"}},t.Descripcion||"")),React.createElement("div",{className:"panel-body",style:{height:"90%"}},React.createElement("h3",null,"Plantilla Dia ",t.Dia||""),React.createElement("div",{style:{height:"87%",overflow:"auto",border:"solid #bfbfbf 1px",background:"#f2f2f2"}},React.createElement(f,null)),React.createElement("i",{className:"btn btn-success btn-block",onClick:u,style:{marginTop:"10px"}},React.createElement("strong",null,"Guardar"),React.createElement("i",{className:"fa fa-download",style:{marginLeft:"5px"}})))))},BtnCriterio=function(n){var t=n.color,i=n.criterio,r=n.evento;return React.createElement("label",{className:"btn btn-default",onClick:r,style:{background:t}},i)},ModalCambioIcidecia=function(n){var t=n.empleado,i=n.listaInsidencias,r=n.evCambiarPuesto,u=n.evGuardar,f=t.Nombre,e=t.Checador,o=t.Color,s=t.Descripcion,h=t.Puesto;return React.createElement("div",{id:"Cambio_incidencia",className:"modal_incidencias"},React.createElement("div",null,React.createElement("i",{id:"btn_cerrar_incidencia",className:"fa fa-close",onClick:function(){return document.querySelector("#Cambio_incidencia").style.display="none"}}),React.createElement("strong",null,f),React.createElement("hr",null),React.createElement(BtnCriterio,{color:o,criterio:e}),React.createElement("div",{id:"contenedor_criterios"},i.map(function(n){return React.createElement(BtnCriterio,{color:n.Color,criterio:n.Criterio,evento:function(){return r(n)}})})),React.createElement("i",{className:"btn btn-success fa fa-save",id:"guardar_cambio_incidencias",onClick:u}," Guardar")))},ModalAgregarObservaciones=function(n){var t=n.empleado,i=n.evObservaciones,r=n.evGuardar,u=t.Nombre,f=t.Checador,e=t.Color,o=t.Descripcion,s=t.Puesto;return React.createElement("div",{id:"Cambio_incidencia_observacion",className:"modal_incidencias"},React.createElement("div",null,React.createElement("i",{id:"btn_cerrar_incidencia",className:"fa fa-close",onClick:function(){return document.querySelector("#Cambio_incidencia_observacion").style.display="none"}}),React.createElement("strong",null,u),React.createElement("hr",null),React.createElement(BtnCriterio,{color:e,criterio:f}),React.createElement("div",{id:"contenedor_criterios_descripcion"},React.createElement("textarea",{rows:"4",className:"form-control",cols:"50",onChange:i,value:o})),React.createElement("i",{className:"btn btn-success fa fa-save",id:"guardar_cambio_incidencias",onClick:r},"Guardar")))},Resultados=function(n){var t=n.Establecimiento,i=n.Departamentos,r=n.evReporte,u=function(n){var t=n.split(" ");return t[0]},f=function(){return i.map(function(n){return[React.createElement("tr",null,React.createElement("td",{style:{color:"#FFFFFF",background:"#ff6a00",fontSize:"18px"}},"#"),React.createElement("td",{style:{color:"#FFFFFF",background:"#ff6a00",fontSize:"18px"},colSpan:"2"},n.Descripcion),React.createElement("td",{style:{color:"#FFFFFF",background:"#ff6a00",fontSize:"18px"}},u(n.Dia))),React.createElement(e,{lista:n.Lista})]})},e=function(n){var t=n.lista;return t.map(function(n){return React.createElement("tr",null,React.createElement("td",null,n.Folio),React.createElement("td",null,n.Nombre),React.createElement("td",null,n.Puesto),React.createElement("td",{style:{background:n.Color}},n.Checador))})};return React.createElement("div",null,React.createElement("i",{className:"btn btn-default fa fa-calendar",id:"btn_reporte",onClick:function(){return r(1)}}," Reporte Asistencias Establecimineto."),React.createElement("div",{className:"modal_incidencias",id:"modal_reporte"},React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},React.createElement("i",{className:"fa fa-close",onClick:function(){return r(0)}}),React.createElement("strong",null,"Reporte ",t.nombre||"")),React.createElement("div",{className:"panel-body"},React.createElement("table",{className:"table",id:"tabla_reporte_empleados"},i?React.createElement(f,null):React.createElement("p",null,"Sin Datos"))),React.createElement("i",{className:"btn btn-success fa fa-file-excel-o",onClick:function(){return tableToExcel("tabla_reporte_empleados","Plantilla_"+t.nombre)},style:{marginTop:"15px"}},React.createElement("span",{style:{marginLeft:"5px"}},"Guardar A Ecxel.")))))},tableToExcel=function(){var n="data:application/vnd.ms-excel;base64,",t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="https://www.w3.org/TR/html401/"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}<\/x:Name><x:WorksheetOptions><x:DisplayGridlines/><\/x:WorksheetOptions><\/x:ExcelWorksheet><\/x:ExcelWorksheets><\/x:ExcelWorkbook><\/xml><![endif]--><\/head><body><table>{table}<\/table><\/body><\/html>',i=function(n){return window.btoa(unescape(encodeURIComponent(n)))},r=function(n,t){return n.replace(/{(\w+)}/g,function(n,i){return t[i]})};return function(u,f){u.nodeType||(u=document.getElementById(u));var e={worksheet:f||"Worksheet",table:u.innerHTML};window.location.href=n+i(r(t,e))}}();location.protocol!="http:"&&(location.protocol="http:");ReactDOM.render(React.createElement(Incidencias,null),document.getElementById("root"));