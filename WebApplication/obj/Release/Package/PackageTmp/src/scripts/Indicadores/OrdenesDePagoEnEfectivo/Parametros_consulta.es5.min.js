"use strict";var $MI_URL=window.location.protocol+"//"+window.location.hostname,$URL_MVC="/Globales/",$URL_API="/api/",pase_fecha=function(n){var t=n.split("-");return t[2]+"/"+t[1]+"/"+t[0]},cavecera_parametros=new Vue({el:"#cavecera_parametros",data:{btn_consultar:{tipo:"",icono:"",mensaje:""},filtro:{f1:"",f2:"",cuenta:"",concepto_compra_o_gasto:"Todos",tipo_beneficiario:"Todos",concepto_orden_pago:"Todos",beneficiario:"",nombre_beneficiario:""},cuentas:[],ordenes_pago:[]},created:function(){this.obtener_cuentas();this.obtener_ordenes_pago();this.verificar_Campos()},updated:function(){console.log("updated...");this.verificar_Campos();llenar_tabla_pagos([])},methods:{consultar_orden_de_gasto:function(){this.verificar_Campos()?this.realizar_consuta():alert("Faltan Campos!!!")},buscar_beneficiario:function(){},verificar_Campos:function(){var n=!1;return this.filtro.beneficiario=this.filtro.tipo_beneficiario=="Todos"?"":this.filtro.beneficiario,this.filtro.nombre_beneficiario=this.filtro.tipo_beneficiario=="Todos"?"":this.filtro.nombre_beneficiario,n=this.filtro.f1.length>0&&this.filtro.f2.length>0,n=this.filtro.tipo_beneficiario=="Todos"?n:this.filtro.beneficiario!=""&&n,this.btn_consultar.tipo=n?"btn btn-success btn-round":"btn btn-danger btn-round",this.btn_consultar.icono=n?"fa fa-download":"fa fa-close",this.btn_consultar.mensaje=n?"Consultar Orden De Pago":"Faltan Campos Por Seleccionar!!!",n},obtener_cuentas:function(){var n=this;fetch($URL_MVC+"Combos?tipo=Cuentas_Reporte_Banco_Interno",{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"}})["catch"](function(n){return console.error("Error=>",n)}).then(function(t){return t.json().then(function(t){n.cuentas=t;n.filtro.cuenta=t[0]})})},obtener_ordenes_pago:function(){var n=this;fetch($URL_MVC+"/Conceptos_de_orden_de_pago",{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"}})["catch"](function(n){return console.error("Error=>",n)}).then(function(t){return t.json().then(function(t){return n.ordenes_pago=t})})},obtener_beneficiarios:function(){document.querySelector("#modal_de_efecto_carga").style.display="flex";fetch($URL_API+"Obtener_beneficiarios?tipo="+this.filtro.tipo_beneficiario,{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"}})["catch"](function(n){return console.error("Error=>",n)}).then(function(n){return n.json().then(function(n){modal_beneficiarios.beneficiarios=n;document.querySelector("#modal_de_efecto_carga").style.display="none";document.querySelector("#modal_seleccion_beneficiarios").style.display="flex"})})},realizar_consuta:function(){vista_pagos_por_semana.eliminar_todo();var n={f1:pase_fecha(this.filtro.f1),f2:pase_fecha(this.filtro.f2),cuenta:this.filtro.cuenta,concepto_compra_o_gasto:this.filtro.concepto_compra_o_gasto,tipo_beneficiario:this.filtro.tipo_beneficiario,concepto_orden_pago:this.filtro.concepto_orden_pago,beneficiario:this.filtro.tipo_beneficiario=="Todos"?" ":this.filtro.beneficiario};document.querySelector("#modal_de_efecto_carga").style.display="flex";console.log("Enviar=>",n);fetch($URL_API+"Obtener_ordenes_pago_en_efectivo",{method:"post",credentials:"same-origin",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})["catch"](function(n){console.error("Error=>",n);alert("fallo En La Consulta!!!");document.querySelector("#modal_de_efecto_carga").style.display="none"}).then(function(n){return n.json().then(function(n){llenar_tabla_pagos(n);document.querySelector("#modal_de_efecto_carga").style.display="none"})})}}}),modal_beneficiarios=new Vue({el:"#modal_seleccion_beneficiarios",data:{seleccion:{folio:0,nombre:""},filtro:"",beneficiarios:[]},methods:{seleccionar:function(n){this.seleccion={folio:n.Folio,nombre:n.Nombre}},agregar_seleccion:function(){this.seleccion.folio>0?(cavecera_parametros.filtro.beneficiario=this.seleccion.folio,cavecera_parametros.filtro.nombre_beneficiario=this.seleccion.nombre,console.log("listo"),document.querySelector("#modal_seleccion_beneficiarios").style.display="none",this.seleccion={folio:0,nombre:""},this.filtro="",this.beneficiarios=[]):alert("No A Seleccionado Beneficiario!!!")},cancelar_seleccion:function(){this.seleccion={folio:0,nombre:""};this.filtro="";this.beneficiarios=[];console.log("Cancelado...");document.querySelector("#modal_seleccion_beneficiarios").style.display="none"},classSeleccionado:function(n){return n===this.seleccion.folio?"btn btn-info fa fa-check-circle-o btn_seleccion":"btn btn-default fa fa-circle-o btn_seleccion"},verificar_coincidencias:function(n){var r=n.toString().split(" "),i=this.filtro.toUpperCase().split(" "),t=[];return i.forEach(function(n){t=t.concat(r.filter(function(t){return t.toUpperCase().search(n)>-1}))}),i.length>1?t.length>1:t.length>0}},computed:{filtro_beneficiarios:function(){var n=this;return this.beneficiarios.filter(function(t){return n.verificar_coincidencias(t.Folio)||n.verificar_coincidencias(t.Nombre)})}}});